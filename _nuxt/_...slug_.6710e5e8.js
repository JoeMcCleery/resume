import{k as h,j as x,B as P,I as M,J as S,z as B,K as O,L as j,q as w,M as E,u as _,N as k,O as T,P as $,Q as H,m as I,S as R,a as A,U as N,V as z,E as g,r as V,o as K,e as U,x as q,h as J,W as F}from"./entry.22f1109e.js";function L(l,d){const a=h({});return x(()=>{const i=M(l),{title:t,titleTemplate:e,...s}=i;a.value={title:t,titleTemplate:e,meta:S(s)}}),P(a,d)}const Q=()=>null;function W(...l){const d=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(d);let[a,i,t={}]=l;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof i!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=t.server??!0,t.default=t.default??Q,t.lazy=t.lazy??!1,t.immediate=t.immediate??!0;const e=B(),s=()=>e.isHydrating?e.payload.data[a]:e.static.data[a],u=()=>s()!==void 0;e._asyncData[a]||(e._asyncData[a]={data:h(s()??t.default()),pending:h(!u()),error:O(e.payload._errors,a)});const n={...e._asyncData[a]};n.refresh=n.execute=(r={})=>{if(e._asyncDataPromises[a]){if(r.dedupe===!1)return e._asyncDataPromises[a];e._asyncDataPromises[a].cancelled=!0}if((r._initial||e.isHydrating&&r._initial!==!1)&&u())return s();n.pending.value=!0;const f=new Promise((o,c)=>{try{o(i(e))}catch(v){c(v)}}).then(o=>{if(f.cancelled)return e._asyncDataPromises[a];let c=o;t.transform&&(c=t.transform(o)),t.pick&&(c=G(c,t.pick)),n.data.value=c,n.error.value=null}).catch(o=>{if(f.cancelled)return e._asyncDataPromises[a];n.error.value=o,n.data.value=_(t.default())}).finally(()=>{f.cancelled||(n.pending.value=!1,e.payload.data[a]=n.data.value,n.error.value&&(e.payload._errors[a]=k(n.error.value)),delete e._asyncDataPromises[a])});return e._asyncDataPromises[a]=f,e._asyncDataPromises[a]};const p=()=>n.refresh({_initial:!0}),m=t.server!==!1&&e.payload.serverRendered;{const r=T();if(r&&!r._nuxtOnBeforeMountCbs){r._nuxtOnBeforeMountCbs=[];const o=r._nuxtOnBeforeMountCbs;r&&(j(()=>{o.forEach(c=>{c()}),o.splice(0,o.length)}),w(()=>o.splice(0,o.length)))}m&&e.isHydrating&&u()?n.pending.value=!1:r&&(e.payload.serverRendered&&e.isHydrating||t.lazy)&&t.immediate?r._nuxtOnBeforeMountCbs.push(p):t.immediate&&p(),t.watch&&E(t.watch,()=>n.refresh());const f=e.hook("app:data:refresh",o=>{if(!o||o.includes(a))return n.refresh()});r&&w(f)}const y=Promise.resolve(e._asyncDataPromises[a]).then(()=>n);return Object.assign(y,n),y}function G(l,d){const a={};for(const i of d)a[i]=l[i];return a}const X=async(l,d={},a={})=>{var n,p,m,y,r,f,o;const i=`${JSON.stringify(d)}${l}`,t=$(`${i}-state`,()=>({})),e=H();I(()=>{t.value&&t.value.id&&R(t.value.id,c=>t.value=c,a)});const{data:s,error:u}=await W(`${i}-asyncdata`,()=>e.get(`cdn/stories/${l}`,d));if((n=u.value)!=null&&n.response&&((p=u.value)==null?void 0:p.response.status)>=400&&((m=u.value)==null?void 0:m.response.status)<600)throw k({statusCode:(y=u.value)==null?void 0:y.response.status,statusMessage:((f=(r=u.value)==null?void 0:r.message)==null?void 0:f.message)||"Something went wrong when fetching from storyblok."});return t.value=(o=s.value)==null?void 0:o.data.story,t},Y={key:0},ae=A({__name:"[...slug]",emits:["page-layout","page-colours"],async setup(l,{emit:d}){var u,n,p,m,y,r,f,o,c,v,b,D;let a,i;const t=F(),e=N().params.slug,s=([a,i]=z(()=>X("pages/"+(e&&e.length>0?e.join("/"):"home"),{version:t.public.storyblokVersion,resolve_links:"url"})),a=await a,i(),a);if(!s.value)throw k({statusCode:404,fatal:!0});return d("page-layout",s.value.content.layout),d("page-colours",{light:{textColour:g(s.value.content.text_colour.color),backgroundColour:g(s.value.content.background_colour.color)},dark:{textColour:g(s.value.content.text_colour_dark.color),backgroundColour:g(s.value.content.background_colour_dark.color)}}),L({title:((p=(n=(u=s.value)==null?void 0:u.content)==null?void 0:n.seo)==null?void 0:p.title)||t.public.websiteTitle+(e&&e.length>0?` - ${e.join(" - ")}`:""),ogTitle:((r=(y=(m=s.value)==null?void 0:m.content)==null?void 0:y.seo)==null?void 0:r.title)||t.public.websiteTitle+(e&&e.length>0?` - ${e.join(" - ")}`:""),description:((c=(o=(f=s.value)==null?void 0:f.content)==null?void 0:o.seo)==null?void 0:c.description)||"",ogDescription:((D=(b=(v=s.value)==null?void 0:v.content)==null?void 0:b.seo)==null?void 0:D.description)||"",ogImage:""}),(Z,ee)=>{const C=V("StoryblokComponent");return _(s)?(K(),U("div",Y,[q(C,{blok:_(s).content},null,8,["blok"])])):J("",!0)}}});export{ae as default};
