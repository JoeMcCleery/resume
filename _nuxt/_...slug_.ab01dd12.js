import{m as g,l as D,C as w,J as x,K as P,A as M,L as S,M as O,v as b,N as B,u as h,O as _,P as T,Q as A,S as E,s as H,U as R,a as $,V as j,W as I,G as v,r as N,o as z,e as V,z as K,h as L,X as U}from"./entry.684722da.js";function J(l,f){const t=g({});return D(()=>{const c=x(l),{title:a,titleTemplate:e,...s}=c;t.value={title:a,titleTemplate:e,meta:P(s)}}),w(t,f)}const q=()=>null;function F(...l){const f=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(f);let[t,c,a={}]=l;if(typeof t!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof c!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");a.server=a.server??!0,a.default=a.default??q,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0;const e=M(),s=()=>e.isHydrating?e.payload.data[t]:e.static.data[t],i=()=>s()!==void 0;e._asyncData[t]||(e._asyncData[t]={data:g(s()??a.default()),pending:g(!i()),error:S(e.payload._errors,t)});const o={...e._asyncData[t]};o.refresh=o.execute=(r={})=>{if(e._asyncDataPromises[t]){if(r.dedupe===!1)return e._asyncDataPromises[t];e._asyncDataPromises[t].cancelled=!0}if((r._initial||e.isHydrating&&r._initial!==!1)&&i())return s();o.pending.value=!0;const u=new Promise((n,d)=>{try{n(c(e))}catch(k){d(k)}}).then(n=>{if(u.cancelled)return e._asyncDataPromises[t];let d=n;a.transform&&(d=a.transform(n)),a.pick&&(d=G(d,a.pick)),o.data.value=d,o.error.value=null}).catch(n=>{if(u.cancelled)return e._asyncDataPromises[t];o.error.value=n,o.data.value=h(a.default())}).finally(()=>{u.cancelled||(o.pending.value=!1,e.payload.data[t]=o.data.value,o.error.value&&(e.payload._errors[t]=_(o.error.value)),delete e._asyncDataPromises[t])});return e._asyncDataPromises[t]=u,e._asyncDataPromises[t]};const y=()=>o.refresh({_initial:!0}),m=a.server!==!1&&e.payload.serverRendered;{const r=T();if(r&&!r._nuxtOnBeforeMountCbs){r._nuxtOnBeforeMountCbs=[];const n=r._nuxtOnBeforeMountCbs;r&&(O(()=>{n.forEach(d=>{d()}),n.splice(0,n.length)}),b(()=>n.splice(0,n.length)))}m&&e.isHydrating&&i()?o.pending.value=!1:r&&(e.payload.serverRendered&&e.isHydrating||a.lazy)&&a.immediate?r._nuxtOnBeforeMountCbs.push(y):a.immediate&&y(),a.watch&&B(a.watch,()=>o.refresh());const u=e.hook("app:data:refresh",n=>{if(!n||n.includes(t))return o.refresh()});r&&b(u)}const p=Promise.resolve(e._asyncDataPromises[t]).then(()=>o);return Object.assign(p,o),p}function G(l,f){const t={};for(const c of f)t[c]=l[c];return t}const Q=async(l,f={},t={})=>{var o,y,m,p,r,u,n;const c=`${JSON.stringify(f)}${l}`,a=A(`${c}-state`,()=>({})),e=E();H(()=>{a.value&&a.value.id&&R(a.value.id,d=>a.value=d,t)});const{data:s,error:i}=await F(`${c}-asyncdata`,()=>e.get(`cdn/stories/${l}`,f));if((o=i.value)!=null&&o.response&&((y=i.value)==null?void 0:y.response.status)>=400&&((m=i.value)==null?void 0:m.response.status)<600)throw _({statusCode:(p=i.value)==null?void 0:p.response.status,statusMessage:((u=(r=i.value)==null?void 0:r.message)==null?void 0:u.message)||"Something went wrong when fetching from storyblok."});return a.value=(n=s.value)==null?void 0:n.data.story,a},W={key:0},Y=$({__name:"[...slug]",emits:["pageLayout","pageColours"],async setup(l,{emit:f}){var y,m,p,r,u,n;let t,c;const a=U(),e=j().params.slug,s=([t,c]=I(()=>Q("pages/"+(e&&e.length>0?e.join("/"):"home"),{version:a.public.storyblokVersion,resolve_links:"url"})),t=await t,c(),t);if(!s.value)throw _({statusCode:404,fatal:!0});f("pageLayout",s.value.content.layout),f("pageColours",{light:{textColour:v(s.value.content.text_colour.color),backgroundColour:v(s.value.content.background_colour.color)},dark:{textColour:v(s.value.content.text_colour_dark.color),backgroundColour:v(s.value.content.background_colour_dark.color)}});const i=((p=(m=(y=s.value)==null?void 0:y.content)==null?void 0:m.seo)==null?void 0:p.title)||a.public.websiteTitle+(e&&e.length>0?` - ${e.join(" - ")}`:""),o=((n=(u=(r=s.value)==null?void 0:r.content)==null?void 0:u.seo)==null?void 0:n.description)||"";return J({title:i,ogTitle:i,description:o,ogDescription:o,ogImage:""}),(d,k)=>{const C=N("StoryblokComponent");return h(s)?(z(),V("div",W,[K(C,{blok:h(s).content},null,8,["blok"])])):L("",!0)}}});export{Y as default};
